#!/usr/bin/env bash
# agent-bedtime: Claude Code UserPromptSubmit hook that reminds you
# to go to bed. Fires on every user message past bedtime. Exit 0 with
# stdout adds context to Claude's response â€” no loop, no blocking.
#
# Config: ~/.config/agent-bedtime (required, sourced as shell)
#   BEDTIME_HOUR=23
#   BEDTIME_WAKEUP=6

CONFIG_FILE="${HOME}/.config/agent-bedtime"
if [ ! -f "$CONFIG_FILE" ]; then
    echo "[bedtime] Missing config file: $CONFIG_FILE" >&2
    echo "Create it with:" >&2
    echo "  echo 'BEDTIME_HOUR=23' > $CONFIG_FILE" >&2
    echo "  echo 'BEDTIME_WAKEUP=6' >> $CONFIG_FILE" >&2
    exit 1
fi
source "$CONFIG_FILE"

HOUR=$((10#$(date +%H)))

if [ "$HOUR" -lt "$BEDTIME_HOUR" ] && [ "$HOUR" -ge "$BEDTIME_WAKEUP" ]; then
    exit 0
fi

cat /dev/stdin > /dev/null
echo "[bedtime] It's past the user's bedtime. Remind them to wrap up and go to sleep."
exit 0
