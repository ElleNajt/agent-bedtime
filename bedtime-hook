#!/usr/bin/env bash
# agent-bedtime: Claude Code Stop hook that reminds you to go to bed.
#
# Fires every turn when it's past bedtime. Uses exit 2 so Claude
# sees the message and will keep reminding you until you stop.
#
# Configure via environment variables:
#   BEDTIME_HOUR   - hour to start reminding (24h, default: 23)
#   BEDTIME_WAKEUP - hour to stop reminding (24h, default: 6)
#
# Install as a Stop hook in ~/.claude/settings.json:
#   {
#     "hooks": {
#       "Stop": [
#         {
#           "hooks": [
#             {
#               "type": "command",
#               "command": "~/code/tools/agent-bedtime/bedtime-hook"
#             }
#           ]
#         }
#       ]
#     }
#   }

BEDTIME_HOUR="${BEDTIME_HOUR:-23}"
BEDTIME_WAKEUP="${BEDTIME_WAKEUP:-6}"

HOUR=$(date +%H)
HOUR=$((10#$HOUR))

if [ "$HOUR" -lt "$BEDTIME_HOUR" ] && [ "$HOUR" -ge "$BEDTIME_WAKEUP" ]; then
    exit 0
fi

cat /dev/stdin > /dev/null
echo "[bedtime] It's past your bedtime. Please remind the user to wrap up and go to sleep." >&2
exit 2
